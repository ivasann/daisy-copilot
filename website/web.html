<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAISY - Your Personal AI Life Copilot</title>
    <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700;800&family=Poppins:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Nunito', 'sans-serif'],
                        display: ['Poppins', 'Nunito', 'sans-serif'],
                    },
                    colors: {
                        primary: '#FF4D6D',
                        secondary: '#F5F5F7',
                        accent: '#0B0B0D',
                        dark: '#0B0B0D',
                        light: '#FFFFFF',
                    },
                    animation: {
                        'fade-in': 'fadeIn 1s ease-out',
                        'slide-up': 'slideUp 0.8s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        .glass {
            background: rgba(255, 255, 255, 0.72);
            backdrop-filter: blur(18px);
            border: 1px solid rgba(15, 15, 18, 0.06);
            box-shadow: 0 12px 40px -18px rgba(0, 0, 0, 0.18);
        }

        /* Apple Health Style Pastel Gradients */
        .bg-pastel-blue {
            background: linear-gradient(135deg, #E0F2FE 0%, #BAe6FD 100%);
        }

        .bg-pastel-pink {
            background: linear-gradient(135deg, #FCE7F3 0%, #FBCFE8 100%);
        }

        .bg-pastel-green {
            background: linear-gradient(135deg, #DCFCE7 0%, #BBF7D0 100%);
        }

        .bg-pastel-purple {
            background: linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%);
        }

        .bg-pastel-orange {
            background: linear-gradient(135deg, #FFEDD5 0%, #FED7AA 100%);
        }

        .bg-pastel-cyan {
            background: linear-gradient(135deg, #E0F7FA 0%, #B2EBF2 100%);
        }

        .bg-pastel-indigo {
            background: linear-gradient(135deg, #E0E7FF 0%, #C7D2FE 100%);
        }

        .bg-pastel-rose {
            background: linear-gradient(135deg, #FFE4E6 0%, #FECDD3 100%);
        }

        .bg-pastel-yellow {
            background: linear-gradient(135deg, #FEF9C3 0%, #FEF08A 100%);
        }

        .ios-shadow {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
        }

        @keyframes aurora {
            0% {
                transform: translate(0, 0) scale(1);
                background: var(--primary);
                opacity: 0.2;
            }

            33% {
                transform: translate(10%, 10%) scale(1.1);
                background: var(--accent);
                opacity: 0.15;
            }

            66% {
                transform: translate(-5%, 5%) scale(0.9);
                background: var(--primary);
                opacity: 0.2;
            }

            100% {
                transform: translate(0, 0) scale(1);
                background: var(--accent);
                opacity: 0.15;
            }
        }

        .animate-aurora {
            animation: aurora 20s ease-in-out infinite alternate;
        }

        @keyframes floaty {
            0% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0); }
        }

        .floaty {
            animation: floaty 6s ease-in-out infinite;
        }

        :root {
            --primary: #ff4d6d;
            --ink: #0b0b0d;
            --muted: #f5f5f7;
            --line: #e7e7ea;
            --pastel-blue: #edf4ff;
            --pastel-pink: #fff1f4;
            --pastel-green: #edf7f0;
            --pastel-purple: #f3f0ff;
            --pastel-orange: #fff3e6;
            --pastel-cyan: #e9f6f8;
            --pastel-indigo: #eff1ff;
            --pastel-rose: #fff1f2;
            --pastel-yellow: #fff9e6;
            --dark: #0b0b0d;
            --light: #ffffff;
        }

        * {
            font-family: 'Nunito', sans-serif !important;
            letter-spacing: -0.003em;
        }

        body {
            font-size: 15.5px;
            line-height: 1.6;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
        }

        h1, h2, h3, h4, h5 {
            line-height: 1.15;
        }

        p {
            line-height: 1.7;
        }

        .font-display {
            font-family: 'Poppins', 'Nunito', sans-serif !important;
            letter-spacing: -0.01em;
        }

        .logo-daisy {
            font-family: 'Poppins', 'Nunito', sans-serif !important;
            font-weight: 600;
            letter-spacing: -0.03em;
            text-transform: lowercase;
            color: var(--ink);
        }

        .logo-mark {
            width: 36px;
            height: 36px;
            border-radius: 12px;
            background: radial-gradient(circle at 30% 30%, #ffffff 0%, #f2f2f4 45%, #e6e6ea 100%);
            border: 1px solid rgba(15, 15, 18, 0.06);
            box-shadow: 0 10px 30px -18px rgba(0, 0, 0, 0.35);
        }

        .logo-mark svg {
            width: 20px;
            height: 20px;
        }

        /* Mascot-Symbol Hybrid Daisy SVG Styles */
        .daisy-icon {
            filter: none;
        }

        .daisy-center {
            fill: #FFD23F;
            /* Vibrant Warm Yellow */
        }

        .daisy-petal {
            fill: var(--ink);
            /* Bold Silhouette */
        }

        .daisy-mascot-eye {
            fill: var(--ink);
        }

        .daisy-mascot-smile {
            fill: none;
            stroke: var(--ink);
            stroke-width: 1.2;
            stroke-linecap: round;
        }

        /* Clean Background */
        .bg-daisy-white {
            background: #f7f7f9;
        }

        /* Haptic Pop Effect */
        .haptic-pop {
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .haptic-pop:active {
            transform: scale(0.92);
        }

        /* Voice Pulse Animation */
        @keyframes voice-pulse {
            0% {
                height: 4px;
            }

            50% {
                height: 16px;
            }

            100% {
                height: 4px;
            }
        }

        .voice-bar {
            width: 3px;
            background: var(--primary);
            border-radius: 99px;
            animation: voice-pulse 0.8s ease-in-out infinite;
        }

        /* Memory Vault Shimmer */
        .memory-card {
            position: relative;
            overflow: hidden;
        }

        .memory-card::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transform: rotate(45deg);
            transition: 0.5s;
            opacity: 0;
        }

        .memory-card:hover::after {
            left: 100%;
            opacity: 1;
        }

        .phone-frame {
            border: 12px solid #1a1a1a;
            border-radius: 3rem;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
            box-shadow: 0 50px 100px -20px rgba(0, 0, 0, 0.25), 0 30px 60px -30px rgba(0, 0, 0, 0.3);
        }

        /* DNA Bar Pulsing */
        @keyframes pulse-dna {
            0% {
                opacity: 0.4;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.4;
            }
        }

        .animate-pulse-dna {
            animation: pulse-dna 2s ease-in-out infinite;
        }

        /* Scroll Reveal Hidden State */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .glass-strong {
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(14px);
            border-bottom: 1px solid rgba(15, 15, 18, 0.08);
        }

        .text-gradient {
            background: linear-gradient(135deg, #111827 0%, #6b7280 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card-hover:hover {
            transform: translateY(-6px);
            box-shadow: 0 18px 36px -16px rgba(15, 15, 18, 0.22);
        }

        .bg-ambient {
            background: radial-gradient(1200px 500px at 10% -10%, #ffffff 10%, transparent 60%),
                radial-gradient(900px 500px at 90% 10%, #f6f6f8 0%, transparent 55%),
                radial-gradient(800px 500px at 50% 100%, #f2f2f6 0%, transparent 50%),
                #f7f7f9;
        }

        .noise {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
            mix-blend-mode: multiply;
            opacity: 0.35;
        }

        .theme-pastel {
            --primary: #ff8ab3;
            --accent: #1b1b1f;
            --muted: #f7f1f4;
            --line: #eadde4;
        }

        .theme-pastel .bg-ambient {
            background: radial-gradient(1200px 500px at 10% -10%, #fff6fb 10%, transparent 60%),
                radial-gradient(900px 500px at 90% 10%, #f7f0ff 0%, transparent 55%),
                radial-gradient(800px 500px at 50% 100%, #f2f7ff 0%, transparent 50%),
                #faf7fb;
        }

        @keyframes toastIn {
            from {
                transform: translateY(10px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .toast-enter {
            animation: toastIn 0.35s ease-out;
        }

        .progress-gradient {
            background: linear-gradient(90deg, #111827 0%, #6b7280 100%);
        }

        /* reward bar removed */

        .theme-switcher {
            position: fixed;
            right: 18px;
            bottom: 18px;
            z-index: 120;
        }

        .theme-panel {
            display: none;
            margin-bottom: 8px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.7);
            border-radius: 16px;
            backdrop-filter: blur(12px);
            box-shadow: 0 16px 40px -24px rgba(0, 0, 0, 0.25);
        }

        .theme-panel.active {
            display: flex;
            gap: 8px;
        }

        .theme-dot {
            width: 22px;
            height: 22px;
            border-radius: 999px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            cursor: pointer;
        }

        body[data-bg="sand"] {
            background: radial-gradient(1200px 500px at 10% -10%, #fff7ec 10%, transparent 60%),
                radial-gradient(900px 500px at 90% 10%, #f5efe6 0%, transparent 55%),
                radial-gradient(800px 500px at 50% 100%, #f3ede3 0%, transparent 50%),
                #faf5ec;
        }

        body[data-bg="slate"] {
            background: radial-gradient(1200px 500px at 10% -10%, #f3f4f6 10%, transparent 60%),
                radial-gradient(900px 500px at 90% 10%, #e5e7eb 0%, transparent 55%),
                radial-gradient(800px 500px at 50% 100%, #f9fafb 0%, transparent 50%),
                #f3f4f6;
        }

        body[data-bg="olive"] {
            background: radial-gradient(1200px 500px at 10% -10%, #f6f7f0 10%, transparent 60%),
                radial-gradient(900px 500px at 90% 10%, #eef0e6 0%, transparent 55%),
                radial-gradient(800px 500px at 50% 100%, #f7f8f2 0%, transparent 50%),
                #f4f6ee;
        }

        body[data-bg="stone"] {
            background: radial-gradient(1200px 500px at 10% -10%, #f8f8f8 10%, transparent 60%),
                radial-gradient(900px 500px at 90% 10%, #f0f0f0 0%, transparent 55%),
                radial-gradient(800px 500px at 50% 100%, #f7f7f7 0%, transparent 50%),
                #f6f6f6;
        }

        body[data-bg="default"] {
            background: radial-gradient(1200px 500px at 10% -10%, #ffffff 10%, transparent 60%),
                radial-gradient(900px 500px at 90% 10%, #f6f6f8 0%, transparent 55%),
                radial-gradient(800px 500px at 50% 100%, #f2f2f6 0%, transparent 50%),
                #f7f7f9;
        }

        .anime-widget {
            position: fixed;
            top: 18%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 130;
            padding: 16px 22px;
            border-radius: 20px;
            background: linear-gradient(135deg, #ffe7f4 0%, #eaf1ff 100%);
            box-shadow: 0 20px 50px -30px rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: popIn 0.5s ease-out, floatUpWidget 1.6s ease-in-out forwards;
        }

        .anime-badge {
            width: 42px;
            height: 42px;
            border-radius: 14px;
            background: radial-gradient(circle at 30% 30%, #fff8d1 0%, #ffd35c 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        @keyframes popIn {
            from { transform: translate(-50%, 10px) scale(0.95); opacity: 0; }
            to { transform: translate(-50%, 0) scale(1); opacity: 1; }
        }

        @keyframes floatUpWidget {
            to { transform: translate(-50%, -30px); opacity: 0; }
        }

        .glow-hover:hover {
            box-shadow: 0 12px 30px -18px rgba(255, 123, 190, 0.6);
            transform: translateY(-1px);
        }

        .glow-enabled .glow-hover:hover {
            box-shadow: 0 18px 40px -18px rgba(255, 123, 190, 0.85);
        }

        .avatar-enabled .avatar-stack img {
            box-shadow: 0 0 0 2px rgba(255, 123, 190, 0.6);
        }

        .coin-float {
            position: absolute;
            animation: floatUp 1.2s ease-out forwards;
            font-weight: 700;
            color: #ff7bbe;
            text-shadow: 0 6px 20px rgba(255, 123, 190, 0.5);
        }

        .sparkle {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 999px;
            background: #ffd35c;
            animation: sparkle 0.9s ease-out forwards;
        }

        @keyframes floatUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-60px);
                opacity: 0;
            }
        }

        @keyframes sparkle {
            from {
                transform: scale(1) translate(0, 0);
                opacity: 1;
            }
            to {
                transform: scale(0) translate(20px, -20px);
                opacity: 0;
            }
        }

        .ring-track {
            stroke: rgba(0, 0, 0, 0.08);
        }

        .ring-progress {
            stroke: url(#ringGrad);
        }

        .shimmer-bg {
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            background-size: 200% 100%;
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body
    class="bg-ambient text-gray-900 font-sans antialiased selection:bg-primary selection:text-white overflow-x-hidden">

    <!-- Reward Bar removed: replaced by inline hero badges -->

    <!-- Background Effects -->
    <div class="fixed inset-0 z-0 pointer-events-none overflow-hidden">
        <div class="absolute top-[-120px] right-[-120px] w-[900px] h-[900px] bg-primary/15 rounded-full blur-[140px] animate-aurora">
        </div>
        <div class="absolute bottom-[-200px] left-[-120px] w-[900px] h-[900px] bg-black/5 rounded-full blur-[160px] animate-aurora"
            style="animation-delay: -6s;"></div>
        <div class="absolute top-[20%] left-[10%] w-24 h-24 bg-white/60 rounded-full blur-xl floaty"></div>
        <div class="absolute top-[60%] right-[12%] w-32 h-32 bg-white/50 rounded-full blur-2xl floaty"
            style="animation-delay: -2s;"></div>
        <div class="absolute inset-0 noise"></div>
    </div>

    <!-- Promo Banner -->
    <div class="bg-accent py-2 text-center relative z-50">
        <p class="text-[10px] font-medium uppercase tracking-[0.3em] text-white/90">Experience the Future of Personal
            Intelligence • Beta Access Open</p>
    </div>

    <!-- Navigation -->
    <nav class="fixed w-full z-50 transition-all duration-500 border-b border-transparent" id="navbar">
        <!-- Intelligence Tracker Bar (Sentient UI) -->
        <div class="h-1 w-full bg-primary/10 relative overflow-hidden">
            <div id="dnaBar" class="absolute top-0 left-0 h-full bg-primary transition-all duration-1000 ease-out"
                style="width: 82%;"></div>
            <div
                class="absolute top-0 left-0 h-full w-full bg-gradient-to-r from-transparent via-white/40 to-transparent animate-pulse-dna">
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="flex justify-between items-center h-20 transition-all duration-500" id="navContainer">
                <div class="flex items-center gap-2.5 group cursor-pointer"
                    onclick="window.scrollTo({top:0, behavior:'smooth'})">
                    <div class="logo-mark flex items-center justify-center group-hover:scale-105 transition-transform duration-500">
                        <svg viewBox="0 0 32 32" fill="none" aria-hidden="true">
                            <circle cx="16" cy="16" r="6.5" fill="#0b0b0d" />
                            <g fill="#0b0b0d" opacity="0.22">
                                <circle cx="16" cy="2.5" r="2" />
                                <circle cx="16" cy="29.5" r="2" />
                                <circle cx="2.5" cy="16" r="2" />
                                <circle cx="29.5" cy="16" r="2" />
                                <circle cx="7" cy="7" r="1.8" />
                                <circle cx="25" cy="7" r="1.8" />
                                <circle cx="7" cy="25" r="1.8" />
                                <circle cx="25" cy="25" r="1.8" />
                            </g>
                        </svg>
                    </div>
                    <span class="logo-daisy text-[22px]">daisy</span>
                </div>

                <div class="hidden md:flex items-center gap-10">
                    <a href="#modes"
                        class="text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-accent transition-colors">Intelligence</a>
                    <a href="insights.html"
                        class="text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-accent transition-colors">Insights</a>
                    <a href="#about"
                        class="text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-accent transition-colors">DNA
                        Evolution</a>
                    <a href="#community"
                        class="text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-accent transition-colors">Safety</a>
                    <div class="flex items-center gap-2 bg-black/5 px-3 py-1.5 rounded-full border border-black/10">
                        <div class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-700">Sentient: 82.4%</span>
                    </div>
                </div>

                <div class="flex items-center gap-3">
                    <div
                        class="flex items-center gap-2 bg-black/5 px-3 py-1.5 rounded-full border border-black/10">
                        <i data-lucide="coins" class="w-4 h-4 text-gray-800"></i>
                        <span id="coinBalance" class="text-[10px] font-bold uppercase tracking-widest text-gray-700">0</span>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">coins</span>
                    </div>
                    <div
                        class="hidden sm:flex items-center gap-2 bg-black/5 px-3 py-1.5 rounded-full border border-black/10">
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">lvl</span>
                        <span id="levelBadge" class="text-[10px] font-bold uppercase tracking-widest text-gray-700">0</span>
                    </div>
                    <div
                        class="hidden sm:flex items-center gap-2 bg-black/5 px-3 py-1.5 rounded-full border border-black/10">
                        <span class="text-[9px] font-bold uppercase tracking-widest text-gray-400">streak</span>
                        <span id="streakCount" class="text-[10px] font-bold uppercase tracking-widest text-gray-700">0</span>
                    </div>
                    <button class="text-gray-400 hover:text-accent transition-colors haptic-pop">
                        <i data-lucide="search" class="w-5 h-5"></i>
                    </button>
                    <button id="openShop"
                        class="hidden sm:inline-flex items-center gap-2 px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest border border-black/10 text-gray-700 hover:text-black hover:border-black/20 transition-all haptic-pop">
                        Theme Shop
                    </button>
                    <button
                        class="bg-accent text-white px-6 py-2.5 rounded-full text-[10px] font-bold uppercase tracking-widest hover:bg-black transition-all shadow-lg shadow-black/20 haptic-pop">
                        Try Beta
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden glass-strong border-t border-primary/10">
            <div class="px-6 py-4 space-y-4">
                <a href="#modes" class="block text-xs font-semibold uppercase tracking-widest">AI Modes</a>
                <a href="#evolution" class="block text-xs font-semibold uppercase tracking-widest">Evolution</a>
                <a href="#reviews" class="block text-xs font-semibold uppercase tracking-widest">Trust</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="relative z-10 pt-32 pb-20 lg:pt-48 lg:pb-32 overflow-hidden">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div class="space-y-8 animate-fade-in">
                    <div
                        class="inline-flex items-center gap-2 px-4 py-1 rounded-full bg-black/5 text-gray-700 text-[10px] font-bold uppercase tracking-[0.2em] mb-4">
                        <span class="w-1.5 h-1.5 bg-primary rounded-full animate-pulse"></span>
                        Focus Copilot
                    </div>

                    <h1 class="font-display text-5xl lg:text-6xl font-bold text-gray-800 leading-[1.05] mb-6">
                        Calm focus, <span class="text-gradient">real rewards</span>.
                    </h1>

                    <p class="text-sm text-gray-500 max-w-md leading-relaxed mb-6" id="typewriter">
                        <!-- Content injected by JS -->
                    </p>

                    <div class="flex flex-col sm:flex-row gap-4">
                        <button
                            class="px-8 py-4 bg-accent text-white font-medium rounded-full hover:bg-black transition-all hover:scale-[1.02] active:scale-95 flex items-center justify-center gap-2 group shadow-xl shadow-black/10 haptic-pop">
                            Start
                            <i data-lucide="arrow-right"
                                class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                        <button
                            class="px-8 py-4 glass text-gray-900 font-medium rounded-full hover:bg-white/80 transition-all flex items-center justify-center gap-2 haptic-pop text-sm">
                            <i data-lucide="play-circle" class="w-5 h-5"></i>
                            Demo
                        </button>
                    </div>

                    <div class="glass rounded-[20px] p-4 ios-shadow max-w-md">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-[10px] uppercase font-bold tracking-widest text-gray-400">Level</span>
                            <span class="text-[10px] uppercase font-bold tracking-widest text-gray-700">
                                <span id="levelValue">0</span> •
                                <span id="levelProgressText">0/100</span>
                            </span>
                        </div>
                        <div class="w-full h-2 bg-black/10 rounded-full overflow-hidden">
                            <div id="levelProgressBar" class="h-2 progress-gradient w-0 transition-all duration-500"></div>
                        </div>
                    </div>

                    <div class="flex flex-wrap items-center gap-2 pt-2">
                        <div class="flex items-center gap-2 bg-white/70 px-3 py-1.5 rounded-full border border-white/70 shadow-sm">
                            <i data-lucide="coins" class="w-4 h-4 text-gray-700"></i>
                            <span id="rewardCoins" class="text-[10px] font-bold uppercase tracking-widest text-gray-700">0</span>
                            <span class="text-[9px] font-bold uppercase tracking-widest text-gray-500">coins</span>
                        </div>
                        <div class="flex items-center gap-2 bg-white/70 px-3 py-1.5 rounded-full border border-white/70 shadow-sm">
                            <span class="text-[9px] font-bold uppercase tracking-widest text-gray-500">level</span>
                            <span id="rewardLevel" class="text-[10px] font-bold uppercase tracking-widest text-gray-700">0</span>
                        </div>
                        <div class="flex items-center gap-2 bg-white/70 px-3 py-1.5 rounded-full border border-white/70 shadow-sm">
                            <i id="streakFlame" data-lucide="flame" class="w-4 h-4 text-orange-400"></i>
                            <span id="rewardStreak" class="text-[10px] font-bold uppercase tracking-widest text-gray-700">0</span>
                        </div>
                        <span id="streakWarning" class="text-[10px] uppercase font-bold tracking-widest text-orange-500 hidden">Streak at risk</span>
                    </div>

                    <div class="mt-3 max-w-sm">
                        <label class="text-[10px] uppercase font-bold tracking-widest text-gray-400">AI Mode</label>
                        <select id="aiModeSelect"
                            class="mt-2 w-full px-4 py-2.5 rounded-full border border-white/70 bg-white/70 focus:outline-none focus:ring-2 focus:ring-black/20 text-sm">
                            <option>Motivator</option>
                            <option>Coach</option>
                            <option>Companion</option>
                            <option>Reward Master</option>
                            <option>Silent Focus</option>
                        </select>
                    </div>
                    <div class="inline-flex items-center gap-3 bg-white/70 px-4 py-2 rounded-full border border-white/70 shadow-sm">
                        <span class="text-[10px] uppercase font-bold tracking-widest text-gray-400">Daily Quest</span>
                        <span class="text-sm text-gray-700">Finish 1 focus session</span>
                        <span class="text-[10px] font-bold uppercase tracking-widest text-orange-500">+20</span>
                    </div>

                    <div class="flex items-center gap-4 pt-4">
                        <div class="flex -space-x-3 avatar-stack">
                            <img src="https://i.pravatar.cc/150?img=1"
                                class="w-10 h-10 rounded-full border-2 border-darker" alt="User">
                            <img src="https://i.pravatar.cc/150?img=2"
                                class="w-10 h-10 rounded-full border-2 border-darker" alt="User">
                            <img src="https://i.pravatar.cc/150?img=3"
                                class="w-10 h-10 rounded-full border-2 border-darker" alt="User">
                            <img src="https://i.pravatar.cc/150?img=4"
                                class="w-10 h-10 rounded-full border-2 border-darker" alt="User">
                        </div>
                        <div class="text-sm">
                            <div class="flex items-center gap-1 text-yellow-500">
                                <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                <i data-lucide="star" class="w-4 h-4 fill-current"></i>
                            </div>
                            <p class="text-gray-700 dark:text-gray-500">Trusted by 66.6% of sentient beings</p>
                        </div>
                    </div>
                </div>

                <div class="relative flex justify-center lg:justify-end animate-slide-up group">
                    <!-- iOS Device Frame -->
                    <div id="phoneFrame"
                        class="relative phone-frame aspect-[9/19.5] w-[320px] overflow-hidden ios-shadow scale-90 lg:scale-100 origin-bottom">
                        <!-- Content dynamically updated by JS -->
                        <div id="phoneContent" class="h-full flex flex-col pt-8 pb-6 px-5 bg-[#F9F9F9] relative">
                            <!-- Neural Sync Overlay Badge (Sentient UI) -->
                            <div id="syncBadge"
                                class="absolute top-3 left-1/2 -translate-x-1/2 opacity-0 transition-opacity">
                                <span
                                    class="text-[7px] font-bold uppercase tracking-[0.2em] text-primary px-3 py-1 bg-white/90 rounded-full shadow-sm border border-primary/10">Neural
                                    Sync Active</span>
                            </div>

                            <!-- Header -->
                            <div class="flex items-center justify-between mb-6 shrink-0 relative z-10" id="phoneHeader">
                                <div>
                                    <p class="text-[9px] text-gray-400 font-bold uppercase tracking-widest mb-0.5"
                                        id="phoneStatus">DAISY DNA: 82%</p>
                                    <h2 class="text-lg font-bold text-gray-800" id="phoneTitle">Health Mode</h2>
                                </div>
                                <div
                                    class="w-9 h-9 rounded-full bg-pastel-pink flex items-center justify-center border-2 border-white shadow-sm overflow-hidden">
                                    <img src="https://i.pravatar.cc/100?img=47" class="w-full h-full object-cover">
                                </div>
                            </div>

                            <!-- App content placeholder -->
                            <div id="appBody" class="flex-1 flex flex-col transition-all duration-300 relative z-10">
                                <!-- Default Grid injected here or specific Mode view -->
                            </div>

                            <!-- Interaction Hint -->
                            <div id="phoneHint"
                                class="absolute bottom-10 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-20">
                                <span
                                    class="text-[8px] font-bold uppercase tracking-widest text-primary bg-white/95 px-3 py-1.5 rounded-full shadow-lg border border-primary/10">Try
                                    an Intelligence Mode</span>
                            </div>
                        </div>

                        <!-- Home Indicator -->
                        <div class="absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1 bg-gray-300 rounded-full z-20">
                        </div>
                    </div>

                    <!-- Decorative Background for Phone -->
                    <div class="absolute -bottom-10 -right-10 w-64 h-64 bg-primary/10 rounded-full blur-[100px] -z-10">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- AI Modes Grid -->
    <section id="modes" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-[9px] font-bold uppercase tracking-widest mb-4">
                    Intelligence Modes
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-800 mb-4">Choose Your Mode</h2>
                <p class="text-gray-500 text-sm">Every interaction helps Daisy evolve. As you use her more, you'll
                    unlock different parts of her intelligence.</p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4" id="productsGrid">
                <!-- 12 Cards injected by JS -->
            </div>

            <!-- Mode Tools (shown when a mode is selected) -->
            <div id="modeTools" class="mt-12 hidden">
                <div class="glass rounded-[26px] p-6 ios-shadow" id="taskChatPanel">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-display text-lg font-semibold text-gray-900">Quick Actions</h3>
                        <span class="text-[10px] font-bold uppercase tracking-widest text-gray-400">Tasks + Chat</span>
                    </div>
                    <p class="text-sm text-gray-500">Complete tasks, ask Daisy, and keep your streak alive.</p>
                    <div class="flex flex-wrap gap-3 mt-4">
                        <button id="completeTaskBtn"
                            class="px-6 py-3 bg-accent text-white rounded-full text-[10px] font-bold uppercase tracking-widest hover:bg-black transition-all haptic-pop">
                            Complete Task
                        </button>
                    </div>
                    <div class="mt-6">
                        <label class="text-[10px] uppercase font-bold tracking-widest text-gray-400">Ask Daisy (1 coin)</label>
                        <div class="flex gap-2 mt-2">
                            <input id="chatInput" type="text" placeholder="Ask for advice or planning"
                                class="flex-1 px-4 py-2.5 rounded-full border border-black/10 bg-white/80 focus:outline-none focus:ring-2 focus:ring-black/20 text-sm" />
                            <button id="chatSendBtn"
                                class="px-4 py-2.5 bg-black text-white rounded-full text-[10px] font-bold uppercase tracking-widest hover:bg-gray-900 transition-all haptic-pop">
                                Send
                            </button>
                        </div>
                        <div id="chatReply" class="mt-3 text-sm text-gray-600"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section id="how" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                    How It Works
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-900 mb-4">A Copilot That Learns You</h2>
                <p class="text-gray-500 text-sm">Daisy adapts quietly in the background while you stay in control.</p>
            </div>

            <div class="grid md:grid-cols-3 gap-6">
                <div class="glass rounded-[24px] p-6 ios-shadow">
                    <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400 mb-2">01</p>
                    <h3 class="font-display text-lg font-semibold text-gray-900 mb-2">Onboard Once</h3>
                    <p class="text-sm text-gray-500">Share your goals and preferences. Daisy builds a baseline profile.</p>
                </div>
                <div class="glass rounded-[24px] p-6 ios-shadow">
                    <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400 mb-2">02</p>
                    <h3 class="font-display text-lg font-semibold text-gray-900 mb-2">Assist Daily</h3>
                    <p class="text-sm text-gray-500">From planning to coaching, Daisy adapts to your rhythm.</p>
                </div>
                <div class="glass rounded-[24px] p-6 ios-shadow">
                    <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400 mb-2">03</p>
                    <h3 class="font-display text-lg font-semibold text-gray-900 mb-2">Evolve With You</h3>
                    <p class="text-sm text-gray-500">Your preferences sharpen. Suggestions get cleaner and faster.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Daily Quests -->
    <section id="daily-quests" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                    Daily Quest
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-900 mb-4">Complete Today’s Boost</h2>
                <p class="text-gray-500 text-sm">Finish all three quests for a +20 coin dopamine bonus.</p>
            </div>

            <div class="max-w-2xl mx-auto glass rounded-[26px] p-6 ios-shadow">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-semibold text-gray-900">Today’s Quests</h3>
                    <span class="text-[10px] uppercase font-bold tracking-widest text-gray-400">+20 bonus</span>
                </div>
                <ul id="questList" class="space-y-3 text-sm text-gray-700"></ul>
                <div class="mt-5 w-full h-2 bg-black/10 rounded-full overflow-hidden">
                    <div id="questProgress" class="h-2 progress-gradient w-0 transition-all duration-500"></div>
                </div>
                <p id="questStatus" class="text-[10px] text-gray-400 mt-3">Complete all quests to earn the bonus.</p>
            </div>
        </div>
    </section>

    <!-- Stats Dashboard -->
    <section id="stats" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                    Stats
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-900 mb-4">Your Momentum</h2>
                <p class="text-gray-500 text-sm">Daily focus, streak health, and a quick weekly glance.</p>
            </div>

            <div class="grid lg:grid-cols-4 gap-6">
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400">Coins Today</p>
                    <p id="coinsToday" class="text-3xl font-display font-semibold text-gray-900 mt-2">0</p>
                </div>
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400">Focus Minutes</p>
                    <p id="focusMinutesToday" class="text-3xl font-display font-semibold text-gray-900 mt-2">0</p>
                </div>
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400">Streak Days</p>
                    <p id="streakDaysStat" class="text-3xl font-display font-semibold text-gray-900 mt-2">0</p>
                </div>
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400">Weekly Progress</p>
                    <div id="weeklyChart" class="mt-3 grid grid-cols-7 gap-1 items-end h-24"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Daily Actions section removed; tools are inside Intelligence Modes -->

    <!-- History -->
    <section id="history" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                    History
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-900 mb-4">Your Recent Progress</h2>
                <p class="text-gray-500 text-sm">Tasks, pomodoros, and streak activity from the last 7 days.</p>
            </div>

            <div class="grid lg:grid-cols-3 gap-6">
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <h3 class="text-sm font-semibold text-gray-900 mb-4">Recent Tasks</h3>
                    <ul id="historyTasks" class="space-y-2 text-sm text-gray-600">
                        <li class="text-gray-400">No tasks yet.</li>
                    </ul>
                </div>
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <h3 class="text-sm font-semibold text-gray-900 mb-4">Pomodoro Sessions</h3>
                    <ul id="historyPomodoros" class="space-y-2 text-sm text-gray-600">
                        <li class="text-gray-400">No sessions yet.</li>
                    </ul>
                </div>
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <h3 class="text-sm font-semibold text-gray-900 mb-4">Streak Calendar</h3>
                    <div id="streakCalendar" class="grid grid-cols-7 gap-2 text-[10px] text-gray-500"></div>
                    <p class="text-[10px] text-gray-400 mt-3">Active days glow.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Trust & Privacy -->
    <section id="trust" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row items-start lg:items-center gap-10">
                <div class="flex-1">
                    <div
                        class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                        Trust & Privacy
                    </div>
                    <h2 class="font-display text-3xl font-bold text-gray-900 mb-4">Designed for Safety by Default</h2>
                    <p class="text-gray-500 text-sm max-w-md">Control your data, manage your memory, and stay informed with transparent settings.</p>
                </div>
                <div class="flex-1 grid sm:grid-cols-3 gap-4 w-full">
                    <div class="glass rounded-[20px] p-5 text-center ios-shadow">
                        <i data-lucide="shield" class="w-6 h-6 text-gray-900 mx-auto mb-3"></i>
                        <p class="text-sm font-semibold text-gray-900">Private by Design</p>
                        <p class="text-xs text-gray-500 mt-1">Clear controls and audit trails.</p>
                    </div>
                    <div class="glass rounded-[20px] p-5 text-center ios-shadow">
                        <i data-lucide="lock" class="w-6 h-6 text-gray-900 mx-auto mb-3"></i>
                        <p class="text-sm font-semibold text-gray-900">Encrypted Memory</p>
                        <p class="text-xs text-gray-500 mt-1">Your data stays protected.</p>
                    </div>
                    <div class="glass rounded-[20px] p-5 text-center ios-shadow">
                        <i data-lucide="toggle-right" class="w-6 h-6 text-gray-900 mx-auto mb-3"></i>
                        <p class="text-sm font-semibold text-gray-900">You're in Control</p>
                        <p class="text-xs text-gray-500 mt-1">Pause, review, or delete.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="py-24 relative z-10 reveal">
        <div class="max-w-3xl mx-auto px-6 lg:px-8">
            <div class="text-center mb-10">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                    FAQ
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-900 mb-2">Answers, Clearly</h2>
                <p class="text-gray-500 text-sm">Short and direct. No fluff.</p>
            </div>
            <div class="space-y-3">
                <details class="glass rounded-[18px] p-5 ios-shadow">
                    <summary class="cursor-pointer text-sm font-semibold text-gray-900">Is Daisy a chatbot or an assistant?</summary>
                    <p class="text-sm text-gray-500 mt-2">Daisy is a personal AI copilot that blends coaching, planning, and memory in one place.</p>
                </details>
                <details class="glass rounded-[18px] p-5 ios-shadow">
                    <summary class="cursor-pointer text-sm font-semibold text-gray-900">Can I control what Daisy remembers?</summary>
                    <p class="text-sm text-gray-500 mt-2">Yes. You can review, pause, or delete memories any time.</p>
                </details>
                <details class="glass rounded-[18px] p-5 ios-shadow">
                    <summary class="cursor-pointer text-sm font-semibold text-gray-900">Is there a free plan?</summary>
                    <p class="text-sm text-gray-500 mt-2">The beta is free while we refine the experience.</p>
                </details>
            </div>
        </div>
    </section>

    <!-- Testimonials -->
    <section id="testimonials" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-14">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                    People Love Daisy
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-900 mb-2">Calm, Clear, and Useful</h2>
                <p class="text-gray-500 text-sm">Early users say Daisy feels less like software and more like support.</p>
            </div>

            <div class="grid md:grid-cols-3 gap-6">
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <p class="text-sm text-gray-600 leading-relaxed">“The planning flow is effortless. It quietly nudges me toward the right next step without noise.”</p>
                    <div class="flex items-center gap-3 mt-6">
                        <img src="https://i.pravatar.cc/80?img=11" alt="Ava"
                            class="w-10 h-10 rounded-full border border-black/10" />
                        <div>
                            <p class="text-sm font-semibold text-gray-900">Ava K.</p>
                            <p class="text-xs text-gray-500">Product Designer</p>
                        </div>
                    </div>
                </div>
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <p class="text-sm text-gray-600 leading-relaxed">“The memory and context are the real magic. Daisy keeps everything aligned without being intrusive.”</p>
                    <div class="flex items-center gap-3 mt-6">
                        <img src="https://i.pravatar.cc/80?img=22" alt="Noah"
                            class="w-10 h-10 rounded-full border border-black/10" />
                        <div>
                            <p class="text-sm font-semibold text-gray-900">Noah R.</p>
                            <p class="text-xs text-gray-500">Founder</p>
                        </div>
                    </div>
                </div>
                <div class="glass rounded-[22px] p-6 ios-shadow">
                    <p class="text-sm text-gray-600 leading-relaxed">“It feels like a calm co‑pilot. The tone is clean, and the guidance is consistently helpful.”</p>
                    <div class="flex items-center gap-3 mt-6">
                        <img src="https://i.pravatar.cc/80?img=31" alt="Maya"
                            class="w-10 h-10 rounded-full border border-black/10" />
                        <div>
                            <p class="text-sm font-semibold text-gray-900">Maya S.</p>
                            <p class="text-xs text-gray-500">Student</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Waitlist -->
    <section id="waitlist" class="py-24 relative z-10 reveal">
        <div class="max-w-4xl mx-auto px-6 lg:px-8">
            <div class="glass rounded-[28px] p-8 md:p-12 ios-shadow">
                <div class="flex flex-col md:flex-row items-start md:items-center gap-8">
                    <div class="flex-1">
                        <div
                            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/5 text-gray-700 text-[9px] font-bold uppercase tracking-widest mb-4">
                            Early Access
                        </div>
                        <h2 class="font-display text-3xl font-bold text-gray-900 mb-3">Join the Daisy Waitlist</h2>
                        <p class="text-gray-500 text-sm">Be first to try new modes, memory features, and priority support.</p>
                    </div>
                    <form id="waitlistForm" class="flex-1 w-full">
                        <div class="flex flex-col sm:flex-row gap-3">
                            <input id="waitlistEmail" type="email" placeholder="you@email.com"
                                class="w-full px-4 py-3 rounded-full border border-black/10 bg-white/80 focus:outline-none focus:ring-2 focus:ring-black/20 text-sm" />
                            <button id="waitlistSubmit" type="button"
                                class="px-6 py-3 bg-accent text-white rounded-full text-[10px] font-bold uppercase tracking-widest hover:bg-black transition-all shadow-lg shadow-black/20 haptic-pop">
                                Request Access
                            </button>
                        </div>
                        <p id="waitlistStatus" class="text-[10px] text-gray-400 mt-3">No spam. Unsubscribe anytime.</p>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="grid lg:grid-cols-2 gap-16 items-center">
                <div class="relative group">
                    <div class="aspect-square overflow-hidden rounded-[3rem] shadow-2xl relative z-10">
                        <img src="https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=1000&h=1000&fit=crop"
                            alt="AI Abstraction"
                            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                    </div>
                    <div
                        class="absolute -bottom-6 -right-6 w-32 h-32 bg-primary/20 rounded-full blur-3xl -z-10 animate-aurora">
                    </div>
                </div>

                <div class="space-y-6">
                    <h2 class="font-display text-4xl font-bold text-gray-800 leading-tight">The Future of Companionship
                    </h2>
                    <p class="text-gray-500 leading-relaxed text-sm">Daisy isn't just an app; she is the result of a
                        vision to make technology feel human. We believe your digital tools should be as empathetic,
                        funny, and supportive as your best friend.</p>
                    <p class="text-gray-500 leading-relaxed text-sm">By blending advanced neural networks with a
                        carefully crafted personality, we've created a copilot that doesn't just process data—it
                        understands you. Whether you're coding a new project or need a midnight roast, Daisy evolves to
                        meet you exactly where you are.</p>

                    <button
                        class="px-8 py-3 bg-primary text-white text-[10px] font-bold uppercase tracking-widest rounded-full hover:bg-accent transition-all shadow-lg shadow-primary/20 haptic-pop">
                        Join the DNA Evolution
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="py-24 bg-dark/5 shadow-inner reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div class="text-center">
                    <p class="font-display text-4xl font-bold text-primary mb-1">99.9%</p>
                    <p class="text-[9px] uppercase font-bold tracking-[0.1em] text-gray-400">Response Accuracy</p>
                </div>
                <div class="text-center">
                    <p class="font-display text-4xl font-bold text-primary mb-1">24/7</p>
                    <p class="text-[9px] uppercase font-bold tracking-[0.1em] text-gray-400">Active Copilot</p>
                </div>
                <div class="text-center">
                    <p class="font-display text-4xl font-bold text-primary mb-1">12+</p>
                    <p class="text-[9px] uppercase font-bold tracking-[0.1em] text-gray-400">Intelligence Modes</p>
                </div>
                <div class="text-center">
                    <p class="font-display text-4xl font-bold text-primary mb-1">Zero</p>
                    <p class="text-[9px] uppercase font-bold tracking-[0.1em] text-gray-400">Data Sharing</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Memory Vault Section (NEW) -->
    <section id="memory" class="py-24 relative overflow-hidden reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-[9px] font-bold uppercase tracking-widest mb-4">
                    The Memory Vault
                </div>
                <h2 class="font-display text-3xl font-bold text-gray-800 mb-4">Dynamic Memory Profile</h2>
                <p class="text-gray-500 text-sm">Every interaction is a synapse. DAISY's vault stores your shared
                    growth, making every response feel uniquely yours.</p>
            </div>

            <div class="grid md:grid-cols-3 lg:grid-cols-4 gap-6">
                <!-- Memory Cards -->
                <div
                    class="memory-card glass p-6 rounded-[2.5rem] bg-white border border-primary/5 hover:translate-y-[-5px] transition-all">
                    <div class="text-[10px] font-bold text-primary mb-2 uppercase tracking-tighter">Sync Moment • 02:44
                        AM</div>
                    <p class="text-sm font-bold text-gray-800 mb-3">Optimization Suggestion</p>
                    <p class="text-[11px] text-gray-400 leading-relaxed italic">"Integrated React useMemo hook after
                        analyzing your state bottlenecks."</p>
                </div>
                <div
                    class="memory-card glass p-6 rounded-[2.5rem] bg-white border border-primary/5 hover:translate-y-[-5px] transition-all">
                    <div class="text-[10px] font-bold text-primary mb-2 uppercase tracking-tighter">Emotion Sync • 11:21
                        PM</div>
                    <p class="text-sm font-bold text-gray-800 mb-3">Mood Baseline Adjust</p>
                    <p class="text-[11px] text-gray-400 leading-relaxed italic">"Detected elevated stress levels.
                        Switching tone to Empathy/Support."</p>
                </div>
                <div
                    class="memory-card glass p-6 rounded-[2.5rem] bg-white border border-primary/5 hover:translate-y-[-5px] transition-all">
                    <div class="text-[10px] font-bold text-primary mb-2 uppercase tracking-tighter">Recall • 3 Days Ago
                    </div>
                    <p class="text-sm font-bold text-gray-800 mb-3">Project Milestones</p>
                    <p class="text-[11px] text-gray-400 leading-relaxed italic">"Remembered your goal to finish user
                        authentication before Friday."</p>
                </div>
                <div
                    class="memory-card glass p-6 rounded-[2.5rem] bg-white border border-primary/5 hover:translate-y-[-5px] transition-all">
                    <div class="text-[10px] font-bold text-primary mb-2 uppercase tracking-tighter">AI Evolution •
                        Ongoing</div>
                    <p class="text-sm font-bold text-gray-800 mb-3">DNA Synthesis</p>
                    <p class="text-[11px] text-gray-400 leading-relaxed italic">"Shared context density increased by 14%
                        this week. Intelligence Synced."</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="community" class="py-24 relative z-10 reveal">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="grid lg:grid-cols-3 gap-12">
                <div
                    class="p-8 rounded-[2.5rem] bg-white border border-primary/5 shadow-lg shadow-primary/5 hover:-translate-y-2 transition-transform">
                    <div class="w-12 h-12 bg-pastel-blue rounded-[24%] flex items-center justify-center mb-6 shadow-sm">
                        <i data-lucide="brain" class="w-6 h-6 text-blue-500"></i>
                    </div>
                    <h3 class="font-display text-xl font-bold text-gray-800 mb-4">Evolving DNA</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">Daisy remembers every conversation, building a
                        unique memory profile that allows her to understand your humor, stress triggers, and goals.</p>
                </div>

                <div
                    class="p-8 rounded-[2.5rem] bg-white border border-primary/5 shadow-lg shadow-primary/5 hover:-translate-y-2 transition-transform">
                    <div class="w-12 h-12 bg-pastel-pink rounded-[24%] flex items-center justify-center mb-6 shadow-sm">
                        <i data-lucide="heart" class="w-6 h-6 text-pink-500"></i>
                    </div>
                    <h3 class="font-display text-xl font-bold text-gray-800 mb-4">Hyper Personal</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">She doesn't just answer questions; she anticipates
                        needs. From suggesting a focus mode when you're busy to a roast when you need a laugh.</p>
                </div>

                <div
                    class="p-8 rounded-[2.5rem] bg-white border border-primary/5 shadow-lg shadow-primary/5 hover:-translate-y-2 transition-transform">
                    <div
                        class="w-12 h-12 bg-pastel-green rounded-[24%] flex items-center justify-center mb-6 shadow-sm">
                        <i data-lucide="shield-check" class="w-6 h-6 text-green-600"></i>
                    </div>
                    <h3 class="font-display text-xl font-bold text-gray-800 mb-4">Safe & Respectful</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">Your data never leaves your device's reach. Daisy
                        is encrypted, non-judgmental, and programmed with strict safety and respect protocols.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-24 relative z-10 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-primary/20 to-secondary/20 opacity-30"></div>
        <div class="max-w-5xl mx-auto px-6 lg:px-8 relative z-10 text-center">
            <h2 class="font-display text-3xl font-bold text-gray-800 mb-6">Experience the Evolution</h2>
            <p class="text-gray-500 mb-10 max-w-xl mx-auto uppercase text-xs tracking-[0.2em] font-bold">Daisy learns
                from every interaction to better serve your unique lifestyle.</p>

            <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto mb-8"
                onsubmit="event.preventDefault(); alert('Welcome to Nomad!');">
                <input type="email" placeholder="Enter your email"
                    class="flex-1 px-6 py-4 rounded-full bg-white/10 border border-white/10 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all">
                <button type="submit"
                    class="px-8 py-4 bg-primary text-dark font-bold rounded-full hover:bg-primary/90 transition-all hover:scale-105 active:scale-95 whitespace-nowrap haptic-pop">
                    Get Started
                </button>
            </form>

            <p class="text-sm text-gray-600 dark:text-gray-500">Free forever. Upgrade anytime for premium features.</p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="border-t border-white/5 pt-16 pb-8 relative z-10 glass-strong">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-8 mb-12">
                <div class="col-span-2">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="font-display font-bold text-xl text-primary tracking-[0.2em]">DAISY</span>
                    </div>
                    <p
                        class="text-[10px] uppercase font-bold tracking-widest text-gray-400 leading-relaxed mb-4 max-w-xs">
                        An evolving digital companion designed to help you navigate life with ease.
                    </p>
                    <div class="flex gap-4">
                        <a href="#"
                            class="w-10 h-10 rounded-full glass flex items-center justify-center hover:bg-primary/20 hover:text-primary transition-all haptic-pop">
                            <i data-lucide="twitter" class="w-5 h-5"></i>
                        </a>
                        <a href="#"
                            class="w-10 h-10 rounded-full glass flex items-center justify-center hover:bg-primary/20 hover:text-primary transition-all haptic-pop">
                            <i data-lucide="instagram" class="w-5 h-5"></i>
                        </a>
                        <a href="#"
                            class="w-10 h-10 rounded-full glass flex items-center justify-center hover:bg-primary/20 hover:text-primary transition-all haptic-pop">
                            <i data-lucide="youtube" class="w-5 h-5"></i>
                        </a>
                    </div>
                </div>

                <div>
                    <h4 class="text-[10px] uppercase font-bold tracking-widest text-gray-800 mb-4">Intelligence</h4>
                    <ul class="space-y-2 text-[10px] uppercase font-bold tracking-widest text-gray-400">
                        <li><a href="#modes" class="hover:text-primary transition-colors">AI Modes</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Personalization</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Memory</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Voice</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-[10px] uppercase font-bold tracking-widest text-gray-800 mb-4">Company</h4>
                    <ul class="space-y-2 text-[10px] uppercase font-bold tracking-widest text-gray-400">
                        <li><a href="#" class="hover:text-primary transition-colors">Our Mission</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Privacy First</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Radical Trust</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Contact</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-semibold text-gray-900 dark:text-white mb-4">Legal</h4>
                    <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                        <li><a href="#" class="hover:text-primary transition-colors">Privacy</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Terms</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">Cookie Policy</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-white/5 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400">© 2024 DAISY AI. All rights
                    reserved.</p>
                <div class="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-500">
                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                    All systems operational
                </div>
            </div>
        </div>
    </footer>

    <!-- Theme Shop Modal -->
    <div id="shopModal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm"></div>
        <div class="relative max-w-xl mx-auto mt-28 p-6">
            <div class="glass rounded-[28px] p-6 ios-shadow">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-display text-xl font-semibold text-gray-900">Theme Shop</h3>
                    <button id="closeShop" class="text-gray-500 hover:text-black haptic-pop">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                <div id="shopItems" class="space-y-4"></div>
                <p class="text-[10px] text-gray-400 mt-4">Unlock once. Use forever.</p>
            </div>
        </div>
    </div>

    <!-- Toasts -->
    <div id="toastContainer" class="fixed bottom-6 right-6 z-[110] space-y-2"></div>
    <div id="rewardLayer" class="fixed inset-0 pointer-events-none z-[105]"></div>

    <!-- Theme Switcher -->
    <div class="theme-switcher">
        <div id="themePanel" class="theme-panel">
            <button class="theme-dot" data-bg="default" style="background:#f7f7f9"></button>
            <button class="theme-dot" data-bg="sand" style="background:#f4eadc"></button>
            <button class="theme-dot" data-bg="slate" style="background:#e5e7eb"></button>
            <button class="theme-dot" data-bg="olive" style="background:#eef0e6"></button>
            <button class="theme-dot" data-bg="stone" style="background:#f1f1f1"></button>
        </div>
        <button id="themeToggle"
            class="w-12 h-12 rounded-full bg-white/80 border border-white/70 shadow-lg flex items-center justify-center">
            <i data-lucide="palette" class="w-5 h-5 text-gray-700"></i>
        </button>
    </div>

    <script>
        window.DAISY_API_BASE = "http://localhost:8000";
    </script>
    <script src="api.js"></script>
    <script type="module">
        import { Dopamine } from './dopamine.js';
        import { AIModes } from './aiModes.js';
        window.Dopamine = Dopamine;
        window.AIModes = AIModes;
    </script>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Daisy AI Modes data (12 Modes)
        const daisyModes = [
            { name: 'Smart Tutor', status: 'Expert', icon: 'graduation-cap', bg: 'bg-pastel-blue', text: 'text-blue-500', category: 'Study', desc: 'Step-by-step help with complex problems.' },
            { name: 'Life Coach', status: 'Active', icon: 'heart', bg: 'bg-pastel-pink', text: 'text-pink-500', category: 'Habits', desc: 'The gentle push you need to stay on track.' },
            { name: 'Relationship', status: 'Safe', icon: 'users', bg: 'bg-pastel-green', text: 'text-green-600', category: 'Advice', desc: 'Secure and respectful guidance for life.' },
            { name: 'Creative', status: 'New', icon: 'sparkles', bg: 'bg-pastel-purple', text: 'text-purple-600', category: 'Idea', desc: 'Unleash your imagination with AI.' },
            { name: 'Fun Mode', status: 'Witty', icon: 'smile', bg: 'bg-pastel-orange', text: 'text-orange-500', category: 'Laugh', desc: 'Jokes, roasts, and witty comebacks.' },
            { name: 'Coding Buddy', status: 'Pro', icon: 'code', bg: 'bg-pastel-cyan', text: 'text-cyan-600', category: 'Dev', desc: 'Review, debug, and write code faster.' },
            { name: 'Fitness Coach', status: 'Strong', icon: 'dumbbell', bg: 'bg-pastel-indigo', text: 'text-indigo-600', category: 'Workouts', desc: 'Daily routines tailored to your body.' },
            { name: 'Sleep Coach', status: 'Calm', icon: 'moon', bg: 'bg-pastel-rose', text: 'text-rose-500', category: 'Rest', desc: 'Optimize your recovery and dreams.' },
            { name: 'Money Guide', status: 'Smart', icon: 'piggy-bank', bg: 'bg-pastel-yellow', text: 'text-yellow-600', category: 'Finance', desc: 'Grow your wealth with smart insights.' },
            { name: 'Design Pro', status: 'Art', icon: 'palette', bg: 'bg-pastel-blue', text: 'text-blue-600', category: 'Visuals', desc: 'Create stunning designs in seconds.' },
            { name: 'Focus Mode', status: 'Flow', icon: 'brain', bg: 'bg-pastel-purple', text: 'text-purple-700', category: 'Mind', desc: 'Deep work and concentration boost.' },
            { name: 'Safety Mode', status: 'Secure', icon: 'shield', bg: 'bg-pastel-green', text: 'text-green-700', category: 'Privacy', desc: 'Military-grade encryption for chat.' },
        ];

        // Typewriter Effect
        const typewriterElement = document.getElementById('typewriter');
        const phrases = [
            "One focus block. One reward.",
            "Small wins. Clean streaks."
        ];
        let phraseIndex = 0;
        let charIndex = 0;
        let isDeleting = false;

        function type() {
            const currentPhrase = phrases[phraseIndex];
            if (isDeleting) {
                typewriterElement.textContent = currentPhrase.substring(0, charIndex--);
            } else {
                typewriterElement.textContent = currentPhrase.substring(0, charIndex++);
            }

            if (!isDeleting && charIndex === currentPhrase.length + 1) {
                setTimeout(() => isDeleting = true, 2500);
            } else if (isDeleting && charIndex === 0) {
                isDeleting = false;
                phraseIndex = (phraseIndex + 1) % phrases.length;
            }
            setTimeout(type, isDeleting ? 30 : 60);
        }

        // Phone Interactions
        const appBody = document.getElementById('appBody');
        const phoneFrame = document.getElementById('phoneFrame');
        const phoneTitle = document.getElementById('phoneTitle');
        const phoneStatus = document.getElementById('phoneStatus');

        const defaultPhoneContent = `
            <div class="bg-gray-200/50 rounded-xl px-4 py-2 flex items-center gap-3 mb-6">
                <i data-lucide="search" class="w-4 h-4 text-gray-400"></i>
                <span class="text-xs text-gray-400">Search Modes</span>
            </div>
            <div class="grid grid-cols-3 gap-4 overflow-y-auto pb-12 hide-scrollbar">
                ${daisyModes.map(mode => `
                    <div class="aspect-square ${mode.bg} rounded-[24%] flex items-center justify-center shadow-sm cursor-pointer hover:scale-110 active:scale-95 transition-all duration-300 group/icon haptic-pop" onclick="openMode('${mode.name}')">
                        <i data-lucide="${mode.icon}" class="w-7 h-7 ${mode.text} group-hover/icon:rotate-12 transition-transform"></i>
                    </div>
                `).join('')}
            </div>
            <div class="mt-auto pt-4 border-t border-gray-100 flex justify-between items-center px-4 shrink-0">
                <i data-lucide="home" class="w-5 h-5 text-primary cursor-pointer active:scale-90 transition-transform haptic-pop" onclick="resetPhone()"></i>
                <i data-lucide="activity" class="w-5 h-5 text-gray-300 haptic-pop"></i>
                <i data-lucide="message-circle" class="w-5 h-5 text-gray-300 haptic-pop"></i>
                <i data-lucide="settings" class="w-5 h-5 text-gray-300 haptic-pop"></i>
            </div>
        `;

        function resetPhone() {
            appBody.style.opacity = '0';
            setTimeout(() => {
                phoneTitle.textContent = "Home Intelligence";
                phoneStatus.textContent = "DAISY DNA: 82%";
                document.getElementById('syncBadge').style.opacity = '0';
                document.documentElement.style.setProperty('--primary', '#ff4d6d');
                appBody.innerHTML = defaultPhoneContent;
                lucide.createIcons();
                appBody.style.opacity = '1';
                phoneFrame.style.transform = 'scale(1) rotate(0deg)';
                phoneFrame.style.background = 'white';
            }, 300);
        }

        window.openMode = (name) => {
            const mode = daisyModes.find(m => m.name === name);
            appBody.style.opacity = '0';
            setTimeout(() => {
                phoneTitle.textContent = mode.name;
                phoneStatus.textContent = `Evolution: ${mode.status}`;
                appBody.innerHTML = `
                    <div class="flex-1 flex flex-col pt-2 overflow-y-auto hide-scrollbar">
                        <div class="w-full aspect-[16/10] rounded-2xl ${mode.bg} flex items-center justify-center mb-6 shadow-inner shrink-0">
                            <i data-lucide="${mode.icon}" class="w-12 h-12 ${mode.text} animate-bounce"></i>
                        </div>
                        <div class="px-1">
                            <p class="text-[9px] text-gray-400 uppercase font-bold tracking-widest mb-1">${mode.category}</p>
                            <p class="text-sm text-gray-600 leading-relaxed mb-8">${mode.desc}</p>
                            
                            <div class="space-y-3">
                                <button class="w-full py-3.5 bg-gray-900 text-white font-bold rounded-2xl text-[10px] uppercase tracking-widest shadow-xl hover:bg-gray-800 transition-colors haptic-pop" onclick="startChat('${mode.name}')">
                                    Launch Sentient Chat
                                </button>
                                <button class="w-full py-3.5 bg-white border border-gray-200 text-gray-500 font-bold rounded-2xl text-[10px] uppercase tracking-widest hover:bg-gray-50 transition-colors haptic-pop" onclick="resetPhone()">
                                    Back to Menu
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                lucide.createIcons();
                appBody.style.opacity = '1';
                phoneFrame.style.transform = 'scale(1.02) rotate(1deg)';
            }, 300);
        };

        window.startChat = (modeName) => {
            const mode = daisyModes.find(m => m.name === modeName);
            appBody.style.opacity = '0';
            phoneFrame.style.background = '#F9F9F9';

            // Neural Sync: Update Page Accent Color
            const modeColors = {
                'Smart Tutor': '#3B82F6',
                'Life Coach': '#EC4899',
                'Relationship': '#10B981',
                'Creative': '#8B5CF6',
                'Fun Mode': '#F59E0B',
                'Coding Buddy': '#06B6D4',
                'Fitness Coach': '#6366F1',
                'Sleep Coach': '#F43F5E',
                'Money Guide': '#EAB308',
                'Design Pro': '#3B82F6',
                'Focus Mode': '#8B5CF6',
                'Safety Mode': '#059669'
            };
            const newColor = modeColors[modeName] || '#ff4d6d';
            document.documentElement.style.setProperty('--primary', newColor);

            setTimeout(() => {
                phoneTitle.textContent = "Daisy Chat";
                phoneStatus.textContent = "Establishing Bond...";
                document.getElementById('syncBadge').style.opacity = '1';

                appBody.innerHTML = `
                    <div class="flex-1 flex flex-col gap-4 pt-2">
                        <div class="bg-gray-100 p-4 rounded-t-2xl rounded-br-2xl self-start max-w-[85%] border border-gray-200">
                            <p class="text-[11px] text-gray-700 leading-relaxed">Hey there! I'm initializing my <b>${modeName}</b> sub-module. Ready to dive deep into our session?</p>
                        </div>
                        <div class="bg-primary/5 p-4 rounded-t-2xl rounded-bl-2xl self-end max-w-[85%] border border-primary/10">
                            <p class="text-[11px] text-primary leading-relaxed italic">DNA Sequence Synced. I'm ready.</p>
                        </div>
                        
                        <!-- Voice Pulse Visualizer -->
                        <div class="mt-4 flex flex-col items-center gap-3">
                            <div class="flex items-center gap-1.5 h-6">
                                <div class="voice-bar"></div>
                                <div class="voice-bar" style="animation-delay: 0.1s; height: 12px"></div>
                                <div class="voice-bar" style="animation-delay: 0.2s; height: 18px"></div>
                                <div class="voice-bar" style="animation-delay: 0.3s; height: 10px"></div>
                                <div class="voice-bar" style="animation-delay: 0.4s; height: 14px"></div>
                            </div>
                            <span class="text-[8px] text-primary font-bold uppercase tracking-[0.2em]">Neural Sync Active</span>
                        </div>
                        
                        <div class="mt-auto pb-4">
                            <div class="bg-white border border-gray-200 rounded-2xl p-3 flex items-center justify-between shadow-sm">
                                <span class="text-[10px] text-gray-400">Type a message...</span>
                                <i data-lucide="send" class="w-4 h-4 text-primary opacity-50"></i>
                            </div>
                        </div>
                    </div>
                `;
                lucide.createIcons();
                appBody.style.opacity = '1';
                phoneFrame.style.transform = 'scale(1.05) rotate(0deg)';
                appBody.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 400);
        };

        // Scroll Effects
        const navbar = document.getElementById('navbar');
        const navContainer = document.getElementById('navContainer');
        const dnaBar = document.getElementById('dnaBar');

        window.addEventListener('scroll', () => {
            const scroll = window.scrollY;

            // Navbar Shrink
            if (scroll > 50) {
                navbar.classList.add('glass-strong', 'shadow-lg');
                navContainer.classList.remove('h-20');
                navContainer.classList.add('h-16');
            } else {
                navbar.classList.remove('glass-strong', 'shadow-lg');
                navContainer.classList.remove('h-16');
                navContainer.classList.add('h-20');
            }

            // DNA Bar Progress
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            // Map scroll to 82% - 95% range
            const dnaPercent = 82 + (scrolled * 0.13);
            dnaBar.style.width = dnaPercent + "%";
        });

        // Intersection Observer for Reveal
        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    // Also support the manual opacity/transform logic from the second script
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

        // Initialize
        function init() {
            // Render main grid (bottom section)
            const mainGrid = document.getElementById('productsGrid');
            mainGrid.innerHTML = '';
            daisyModes.forEach(mode => {
                const card = document.createElement('div');
                card.className = 'glass rounded-[2rem] overflow-hidden card-hover group cursor-pointer p-6 bg-white flex flex-col items-center text-center ios-shadow border-none';
                card.innerHTML = `
                    <div class="w-16 h-16 ${mode.bg} rounded-[24%] flex items-center justify-center mb-4 shadow-sm group-hover:scale-110 transition-transform duration-500">
                        <i data-lucide="${mode.icon}" class="w-8 h-8 ${mode.text}"></i>
                    </div>
                    <h3 class="font-display text-sm font-bold text-gray-800 mb-1 leading-tight">${mode.name}</h3>
                    <p class="text-[9px] text-gray-400 uppercase font-bold tracking-widest mb-2">${mode.category}</p>
                    <p class="text-[10px] text-gray-500 leading-relaxed line-clamp-2">${mode.desc}</p>
                `;
                card.onclick = () => {
                    if (mode.name === "Focus Mode") {
                        window.location.href = "focus.html";
                        return;
                    }
                    document.getElementById('modes').scrollIntoView({ behavior: 'smooth' });
                    openMode(mode.name);
                    showModeTools(mode.name);
                };
                mainGrid.appendChild(card);
            });

            resetPhone();
            setTimeout(type, 1000);
            lucide.createIcons();

            // Observe elements for animation (from second observer logic)
            document.querySelectorAll('.card-hover').forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = `all 0.6s ease ${index * 0.1}s`;
                revealObserver.observe(el);
            });
            // Re-initialize reveals for dynamically added elements (from first observer logic)
            document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));
        }

        init();

        function showModeTools(modeName) {
            const tools = document.getElementById('modeTools');
            if (!tools) return;
            tools.classList.remove('hidden');
            tools.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Theme management
        (function initTheme() {
            const stored = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            if (stored === 'dark') document.documentElement.classList.add('dark');
        })();

        function toggleTheme() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            document.getElementById('mobileMenu')?.classList.toggle('hidden');
        }

        // Gamification + Coins
        let currentCoins = 0;
        let themeUnlocked = false;
        let pendingTheme = localStorage.getItem("daisy_theme");

        const coinBalanceEl = document.getElementById('coinBalance');
        const streakCountEl = document.getElementById('streakCount');
        const levelValueEl = document.getElementById('levelValue');
        const levelBadgeEl = document.getElementById('levelBadge');
        const rewardCoinsEl = document.getElementById('rewardCoins');
        const rewardLevelEl = document.getElementById('rewardLevel');
        const rewardStreakEl = document.getElementById('rewardStreak');
        const streakFlameEl = document.getElementById('streakFlame');
        const rewardProgressEl = document.getElementById('rewardProgress');
        const rewardProgressTextEl = document.getElementById('rewardProgressText');
        const streakWarningEl = document.getElementById('streakWarning');
        const coinsTodayEl = document.getElementById('coinsToday');
        const focusMinutesTodayEl = document.getElementById('focusMinutesToday');
        const streakDaysStatEl = document.getElementById('streakDaysStat');
        const levelProgressTextEl = document.getElementById('levelProgressText');
        const levelProgressBarEl = document.getElementById('levelProgressBar');

        function animateCounter(el, from, to, duration = 600) {
            if (!el) return;
            const start = performance.now();
            const range = to - from;
            function tick(now) {
                const progress = Math.min((now - start) / duration, 1);
                const value = Math.round(from + range * progress);
                el.textContent = value;
                if (progress < 1) requestAnimationFrame(tick);
            }
            requestAnimationFrame(tick);
        }

        function playCoinSound() {
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.type = "sine";
                osc.frequency.value = 880;
                gain.gain.value = 0.0001;
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.start();
                gain.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.02);
                gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.25);
                osc.stop(ctx.currentTime + 0.26);
            } catch (_) {
                // Audio may be blocked; ignore.
            }
        }

        function showToast(message, type = "success") {
            const container = document.getElementById('toastContainer');
            if (!container) return;
            const toast = document.createElement('div');
            const color = type === "error" ? "bg-red-500/90" : "bg-black/90";
            toast.className = `toast-enter ${color} text-white text-xs px-4 py-3 rounded-full shadow-lg`;
            toast.textContent = message;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 2800);
        }

        function triggerRewardAnimation(amount, bonus = 0) {
            const layer = document.getElementById('rewardLayer');
            if (!layer || amount <= 0) return;

            const float = document.createElement('div');
            float.className = 'coin-float text-lg';
            float.style.left = '50%';
            float.style.top = '60%';
            float.style.transform = 'translateX(-50%)';
            float.textContent = `+${amount} coins`;
            layer.appendChild(float);

            const sparkleCount = document.documentElement.classList.contains('confetti-enabled') ? 18 : 8;
            for (let i = 0; i < sparkleCount; i += 1) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = `${50 + (Math.random() * 10 - 5)}%`;
                sparkle.style.top = `${60 + (Math.random() * 10 - 5)}%`;
                layer.appendChild(sparkle);
                setTimeout(() => sparkle.remove(), 900);
            }

            setTimeout(() => float.remove(), 1200);

            if (bonus > 0) {
                showToast(`Lucky bonus +${bonus}!`);
            }

            if (window.Dopamine) {
                const cx = window.innerWidth / 2;
                const cy = window.innerHeight * 0.6;
                window.Dopamine.floatCoins(cx, cy, `+${amount}`);
                window.Dopamine.sparkleBurst(cx, cy, bonus > 0 ? 16 : 10);
            }
        }

        function showAnimeWidget(text = "Nice! +5") {
            const widget = document.createElement('div');
            widget.className = 'anime-widget';
            widget.innerHTML = `
                <div class="anime-badge">★</div>
                <div>
                    <p class="text-sm font-semibold text-gray-800">${text}</p>
                    <p class="text-[10px] text-gray-500">Keep the streak alive</p>
                </div>
            `;
            document.body.appendChild(widget);
            setTimeout(() => widget.remove(), 1600);
        }

        function updateBalanceUI(balance, announce = false) {
            const delta = balance.coins - currentCoins;
            if (announce && delta > 0) {
                showToast(`+${delta} coins earned`);
                playCoinSound();
            }
            animateCounter(coinBalanceEl, currentCoins, balance.coins);
            animateCounter(rewardCoinsEl, currentCoins, balance.coins);
            currentCoins = balance.coins;

            if (streakCountEl) streakCountEl.textContent = balance.streak;
            if (levelValueEl) levelValueEl.textContent = balance.level;
            if (levelBadgeEl) levelBadgeEl.textContent = balance.level;
            if (rewardLevelEl) rewardLevelEl.textContent = balance.level;
            if (rewardStreakEl) rewardStreakEl.textContent = balance.streak;
            if (streakFlameEl) {
                const scale = Math.min(1.6, 1 + balance.streak * 0.05);
                streakFlameEl.style.transform = `scale(${scale})`;
            }

            if (levelProgressTextEl) levelProgressTextEl.textContent = `${balance.level_progress}/100`;
            if (levelProgressBarEl) {
                const width = Math.min((balance.level_progress / 100) * 100, 100);
                levelProgressBarEl.style.width = `${width}%`;
            }
            if (rewardProgressEl) {
                const width = Math.min((balance.level_progress / 100) * 100, 100);
                rewardProgressEl.style.width = `${width}%`;
            }
            if (rewardProgressTextEl) rewardProgressTextEl.textContent = `${balance.level_progress}/100`;

            if (coinsTodayEl) coinsTodayEl.textContent = balance.coins_today ?? 0;
            if (focusMinutesTodayEl) focusMinutesTodayEl.textContent = balance.focus_minutes_today ?? 0;
            if (streakDaysStatEl) streakDaysStatEl.textContent = balance.streak;

            const today = new Date().toISOString().slice(0, 10);
            const isActiveToday = balance.last_active_date === today;
            if (streakWarningEl) {
                streakWarningEl.classList.toggle('hidden', isActiveToday);
                if (!isActiveToday) window.Dopamine?.streakWarning?.(streakWarningEl);
            }

            themeUnlocked = balance.theme_unlocked;
            if (themeUnlocked && pendingTheme === "pastel") {
                applyTheme("pastel");
            } else if (!themeUnlocked) {
                applyTheme("default");
            }
            renderShopItems(balance.unlocks);
            applyUnlocks(balance.unlocks);
        }

        async function refreshBalance(announce = false) {
            if (!window.DaisyAPI) return;
            try {
                const balance = await DaisyAPI.getBalance();
                updateBalanceUI(balance, announce);
            } catch (err) {
                showToast(err.message || "Failed to load balance", "error");
            }
        }

        async function refreshHistory() {
            if (!window.DaisyAPI) return;
            try {
                const data = await DaisyAPI.history();
                const tasksEl = document.getElementById('historyTasks');
                const pomosEl = document.getElementById('historyPomodoros');
                const calendarEl = document.getElementById('streakCalendar');

                if (tasksEl) {
                    tasksEl.innerHTML = '';
                    if (!data.tasks.length) {
                        tasksEl.innerHTML = '<li class="text-gray-400">No tasks yet.</li>';
                    } else {
                        data.tasks.slice(0, 6).forEach((t) => {
                            const item = document.createElement('li');
                            item.className = 'flex items-center justify-between';
                            const label = t.type.replace(/_/g, ' ');
                            item.innerHTML = `<span class="text-gray-700">${label}</span><span class="text-gray-400 text-xs">+${t.coins}</span>`;
                            tasksEl.appendChild(item);
                        });
                    }
                }

                if (pomosEl) {
                    pomosEl.innerHTML = '';
                    if (!data.pomodoros.length) {
                        pomosEl.innerHTML = '<li class="text-gray-400">No sessions yet.</li>';
                    } else {
                        data.pomodoros.slice(0, 6).forEach((p) => {
                            const item = document.createElement('li');
                            item.className = 'flex items-center justify-between';
                            item.innerHTML = `<span class="text-gray-700">${p.duration} min</span><span class="text-gray-400 text-xs">+${p.coins}</span>`;
                            pomosEl.appendChild(item);
                        });
                    }
                }

                if (calendarEl) {
                    calendarEl.innerHTML = '';
                    const today = new Date();
                    const activeDates = new Set();
                    data.tasks.forEach((t) => activeDates.add(t.timestamp.slice(0, 10)));
                    data.pomodoros.forEach((p) => activeDates.add(p.completed_at.slice(0, 10)));
                    for (let i = 6; i >= 0; i -= 1) {
                        const d = new Date(today);
                        d.setDate(today.getDate() - i);
                        const dateStr = d.toISOString().slice(0, 10);
                        const cell = document.createElement('div');
                        const active = activeDates.has(dateStr);
                        cell.className = `h-9 rounded-lg flex items-center justify-center border ${active ? 'bg-accent text-white border-accent' : 'bg-white/70 text-gray-500 border-black/10'}`;
                        cell.textContent = dateStr.slice(5);
                        calendarEl.appendChild(cell);
                    }
                }

                const weeklyChart = document.getElementById('weeklyChart');
                if (weeklyChart) {
                    weeklyChart.innerHTML = '';
                    const today = new Date();
                    const totals = [];
                    for (let i = 6; i >= 0; i -= 1) {
                        const d = new Date(today);
                        d.setDate(today.getDate() - i);
                        const dateStr = d.toISOString().slice(0, 10);
                        const taskCoins = data.tasks
                            .filter((t) => t.timestamp.slice(0, 10) === dateStr)
                            .reduce((sum, t) => sum + (t.coins || 0), 0);
                        const pomoCoins = data.pomodoros
                            .filter((p) => p.completed_at.slice(0, 10) === dateStr)
                            .reduce((sum, p) => sum + (p.coins || 0), 0);
                        totals.push(taskCoins + pomoCoins);
                    }
                    const max = Math.max(10, ...totals);
                    totals.forEach((val) => {
                        const bar = document.createElement('div');
                        bar.className = 'bg-black/10 rounded-md';
                        bar.style.height = `${Math.max(12, (val / max) * 96)}px`;
                        bar.style.background = 'linear-gradient(180deg, #ff7bbe 0%, #6b8cff 100%)';
                        weeklyChart.appendChild(bar);
                    });
                }
            } catch (_) {
                // History is non-critical; ignore errors.
            }
        }

        async function refreshQuests() {
            if (!window.DaisyAPI) return;
            const list = document.getElementById('questList');
            const progress = document.getElementById('questProgress');
            const status = document.getElementById('questStatus');
            try {
                const quests = await DaisyAPI.dailyQuestStatus();
                if (list) list.innerHTML = '';
                const total = quests.items.length;
                const done = quests.items.filter((q) => q.done).length;
                const percent = total ? Math.round((done / total) * 100) : 0;
                if (progress) progress.style.width = `${percent}%`;
                if (status) status.textContent = quests.bonus_awarded
                    ? "Bonus claimed. Great work today."
                    : "Complete all quests to earn the bonus.";

                quests.items.forEach((q) => {
                    const li = document.createElement('li');
                    li.className = 'flex items-center gap-3';
                    li.innerHTML = `
                        <input type="checkbox" ${q.done ? "checked" : ""} data-quest="${q.id}"
                            class="w-4 h-4 rounded border-black/20 text-black focus:ring-black/20" />
                        <span class="${q.done ? 'line-through text-gray-400' : 'text-gray-700'}">${q.label}</span>
                    `;
                    list?.appendChild(li);
                });

                list?.querySelectorAll('input[type="checkbox"]').forEach((box) => {
                    box.addEventListener('change', async (e) => {
                        const id = e.target.getAttribute('data-quest');
                        const done = e.target.checked;
                        await DaisyAPI.setQuestDone(id, done);
                        const res = await DaisyAPI.completeDailyQuests();
                        if (res.daily_bonus) {
                            showToast("Daily quest complete! +20 coins");
                            triggerRewardAnimation(res.reward.total, res.reward.bonus);
                            showAnimeWidget("Quest complete! +20");
                            await refreshBalance(true);
                        }
                        await refreshQuests();
                    });
                });
            } catch (_) {
                // ignore
            }
        }

        function applyTheme(theme) {
            const root = document.documentElement;
            if (theme === "pastel") {
                root.classList.add("theme-pastel");
                localStorage.setItem("daisy_theme", "pastel");
                pendingTheme = "pastel";
            } else {
                root.classList.remove("theme-pastel");
                localStorage.setItem("daisy_theme", "default");
                pendingTheme = "default";
            }
        }

        const shopCatalog = [
            { id: "pastel", name: "Pastel Premium Theme", cost: 50, desc: "Soft gradients and a calmer mood.", reason: "theme_unlock" },
            { id: "glow", name: "Glow Hover Effects", cost: 80, desc: "Extra glow on interactive elements.", reason: "glow_unlock" },
            { id: "confetti", name: "Confetti Reward Burst", cost: 120, desc: "Celebrate wins with confetti.", reason: "confetti_unlock" },
            { id: "avatar", name: "Avatar Frame", cost: 60, desc: "Cute frame for your profile card.", reason: "avatar_unlock" },
        ];

        function renderShopItems(unlocks) {
            const container = document.getElementById('shopItems');
            if (!container) return;
            container.innerHTML = '';
            shopCatalog.forEach((item) => {
                const unlocked = !!unlocks?.[item.id];
                const card = document.createElement('div');
                card.className = 'glass rounded-[20px] p-5 flex items-center justify-between relative overflow-hidden';
                card.innerHTML = `
                    <div>
                        <p class="text-sm font-semibold text-gray-900">${item.name}</p>
                        <p class="text-xs text-gray-500">${item.desc}</p>
                        <p class="text-[10px] uppercase font-bold tracking-widest text-gray-400 mt-2">Cost: ${item.cost} coins</p>
                    </div>
                    ${unlocked ? '<span class="absolute top-3 right-3 text-[9px] uppercase font-bold tracking-widest bg-green-500/90 text-white px-2 py-1 rounded-full">Unlocked</span>' : '<span class="absolute top-3 right-3 text-[9px] uppercase font-bold tracking-widest bg-black/80 text-white px-2 py-1 rounded-full">Locked</span>'}
                    <button data-shop="${item.id}"
                        class="px-4 py-2.5 ${unlocked ? 'glass text-gray-900' : 'bg-accent text-white'} rounded-full text-[10px] font-bold uppercase tracking-widest hover:bg-black transition-all haptic-pop">
                        ${unlocked ? 'Apply' : 'Unlock'}
                    </button>
                `;
                container.appendChild(card);
            });
        }

        function applyUnlocks(unlocks) {
            const root = document.documentElement;
            root.classList.toggle('glow-enabled', !!unlocks?.glow);
            root.classList.toggle('confetti-enabled', !!unlocks?.confetti);
            root.classList.toggle('avatar-enabled', !!unlocks?.avatar);
        }

        // Pomodoro
        let pomodoroTimer = null;
        const focusDuration = 1 * 60;
        const breakDuration = 1 * 60;
        let pomodoroLeft = focusDuration;
        let pomodoroMode = "focus";
        const pomodoroDisplayEl = document.getElementById('pomodoroDisplay');
        const pomodoroProgressEl = document.getElementById('pomodoroProgress');
        const pomodoroModeEl = document.getElementById('pomodoroMode');
        const pomodoroRingEl = document.getElementById('pomodoroRing');
        const ringRadius = 80;
        const ringCircumference = 2 * Math.PI * ringRadius;
        if (pomodoroRingEl) {
            pomodoroRingEl.style.strokeDasharray = `${ringCircumference} ${ringCircumference}`;
            pomodoroRingEl.style.strokeDashoffset = `${ringCircumference}`;
        }

        function updatePomodoroUI() {
            const minutes = Math.floor(pomodoroLeft / 60);
            const seconds = pomodoroLeft % 60;
            if (pomodoroDisplayEl) {
                pomodoroDisplayEl.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            }
            if (pomodoroModeEl) {
                pomodoroModeEl.textContent = pomodoroMode === "focus" ? "Focus" : "Break";
            }
            if (pomodoroProgressEl) {
                const total = pomodoroMode === "focus" ? focusDuration : breakDuration;
                const done = (total - pomodoroLeft) / total;
                pomodoroProgressEl.style.width = `${Math.round(done * 100)}%`;
            }
            if (pomodoroRingEl) {
                const total = pomodoroMode === "focus" ? focusDuration : breakDuration;
                const progress = (total - pomodoroLeft) / total;
                const offset = ringCircumference - progress * ringCircumference;
                pomodoroRingEl.style.strokeDashoffset = `${offset}`;
            }
        }

        function startPomodoro() {
            if (pomodoroTimer) return;
            pomodoroTimer = setInterval(async () => {
                if (pomodoroLeft > 0) {
                    pomodoroLeft -= 1;
                    updatePomodoroUI();
                } else {
                    clearInterval(pomodoroTimer);
                    pomodoroTimer = null;
                    if (pomodoroMode === "focus") {
                        await completePomodoro();
                        pomodoroMode = "break";
                        pomodoroLeft = breakDuration;
                        showToast("Break time! 5 minutes");
                        startPomodoro();
                    } else {
                        pomodoroMode = "focus";
                        pomodoroLeft = focusDuration;
                        showToast("Back to focus");
                    }
                }
            }, 1000);
        }

        function pausePomodoro() {
            if (!pomodoroTimer) return;
            clearInterval(pomodoroTimer);
            pomodoroTimer = null;
        }

        function resetPomodoro() {
            pausePomodoro();
            pomodoroMode = "focus";
            pomodoroLeft = focusDuration;
            updatePomodoroUI();
        }

        async function completePomodoro() {
            try {
                const res = await DaisyAPI.completePomodoro({ duration_minutes: 1 });
                const reward = res.reward || { total: 0, bonus: 0 };
                showToast("Pomodoro complete! +10 coins");
                triggerRewardAnimation(reward.total, reward.bonus);
                const celebrate = document.getElementById('pomodoroCelebrate');
                if (celebrate) {
                    celebrate.classList.remove('hidden');
                    celebrate.classList.add('flex');
                    setTimeout(() => {
                        celebrate.classList.add('hidden');
                        celebrate.classList.remove('flex');
                    }, 1800);
                }
                window.Dopamine?.pomodoroCelebration?.();
                if (window.AIModes) {
                    await window.AIModes.applyModeReward({
                        baseCoins: 0,
                        reason: "pomodoro",
                        DaisyAPI: window.DaisyAPI,
                        Dopamine: window.Dopamine,
                        onReward: (amt, bonus) => triggerRewardAnimation(amt, bonus),
                    });
                }
                await refreshBalance(true);
                await refreshHistory();
                await refreshQuests();
            } catch (err) {
                showToast(err.message || "Pomodoro failed", "error");
            } finally {
                resetPomodoro();
            }
        }

        async function completeTask() {
            try {
                const res = await DaisyAPI.completeTask({});
                const reward = res.reward || { total: 0, bonus: 0 };
                showToast("Task complete! +5 coins");
                triggerRewardAnimation(reward.total, reward.bonus);
                showAnimeWidget(`Task done! +${reward.total || 5}`);
                if (window.AIModes) {
                    await window.AIModes.applyModeReward({
                        baseCoins: 0,
                        reason: "task",
                        DaisyAPI: window.DaisyAPI,
                        Dopamine: window.Dopamine,
                        onReward: (amt, bonus) => triggerRewardAnimation(amt, bonus),
                    });
                }
                await refreshBalance(true);
                await refreshHistory();
                await refreshQuests();
            } catch (err) {
                showToast(err.message || "Task failed", "error");
            }
        }

        async function sendChat() {
            const input = document.getElementById('chatInput');
            const output = document.getElementById('chatReply');
            const text = input?.value?.trim();
            if (!text) return;
            if (output) output.textContent = "Thinking…";
            try {
                const res = await DaisyAPI.aiChat({ message: text });
                const mode = window.AIModes?.getMode?.() || "Motivator";
                const context = { coins: currentCoins, streak: streakCountEl?.textContent || 0, prompted: true };
                const localReply = window.AIModes?.generateResponse?.(mode, context);
                if (output) output.textContent = localReply || res.reply;
                await refreshBalance(true);
                await refreshHistory();
                await refreshQuests();
            } catch (err) {
                if (output) output.textContent = "";
                showToast(err.message || "Chat failed", "error");
            } finally {
                if (input) input.value = "";
            }
        }

        function initShopModal() {
            const openBtn = document.getElementById('openShop');
            const closeBtn = document.getElementById('closeShop');
            const modal = document.getElementById('shopModal');
            const container = document.getElementById('shopItems');

            openBtn?.addEventListener('click', async () => {
                modal?.classList.remove('hidden');
                try {
                    const balance = await DaisyAPI.getBalance();
                    renderShopItems(balance.unlocks);
                } catch (_) {
                    // ignore
                }
            });
            closeBtn?.addEventListener('click', () => modal?.classList.add('hidden'));
            modal?.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.add('hidden');
            });
            container?.addEventListener('click', async (e) => {
                const btn = e.target.closest('button[data-shop]');
                if (!btn) return;
                const id = btn.getAttribute('data-shop');
                const item = shopCatalog.find((i) => i.id === id);
                if (!item) return;

                try {
                    const balance = await DaisyAPI.getBalance();
                    const isUnlocked = balance.unlocks?.[item.id];
                    if (isUnlocked) {
                        if (id === "pastel") applyTheme("pastel");
                        if (id === "glow") document.documentElement.classList.add('glow-enabled');
                        if (id === "confetti") document.documentElement.classList.add('confetti-enabled');
                        if (id === "avatar") document.documentElement.classList.add('avatar-enabled');
                        showToast("Applied!");
                        return;
                    }
                    await DaisyAPI.spendCoins({ amount: item.cost, reason: item.reason });
                    if (item.id === "pastel") applyTheme("pastel");
                    window.Dopamine?.shopUnlock?.(item.name);
                    showToast("Unlocked!");
                    await refreshBalance(true);
                } catch (err) {
                    showToast(err.message || "Unlock failed", "error");
                }
            });
        }

        function initActions() {
            document.getElementById('pomodoroStart')?.addEventListener('click', startPomodoro);
            document.getElementById('pomodoroPause')?.addEventListener('click', pausePomodoro);
            document.getElementById('pomodoroReset')?.addEventListener('click', resetPomodoro);
            document.getElementById('completeTaskBtn')?.addEventListener('click', completeTask);
            document.getElementById('chatSendBtn')?.addEventListener('click', sendChat);
            updatePomodoroUI();
        }

        function initAIModes() {
            const select = document.getElementById('aiModeSelect');
            if (!select || !window.AIModes) return;
            select.value = window.AIModes.getMode();
            select.addEventListener('change', (e) => {
                window.AIModes.setMode(e.target.value);
                showToast(`Mode: ${e.target.value}`);
            });
        }

        function initThemeSwitcher() {
            const panel = document.getElementById('themePanel');
            const toggle = document.getElementById('themeToggle');
            const saved = localStorage.getItem('daisy_bg') || 'default';
            document.body.setAttribute('data-bg', saved);

            toggle?.addEventListener('click', () => {
                panel?.classList.toggle('active');
            });

            panel?.querySelectorAll('.theme-dot').forEach((dot) => {
                dot.addEventListener('click', (e) => {
                    const bg = e.currentTarget.getAttribute('data-bg');
                    document.body.setAttribute('data-bg', bg);
                    localStorage.setItem('daisy_bg', bg);
                    panel.classList.remove('active');
                });
            });
        }

        function initWaitlist() {
            const btn = document.getElementById('waitlistSubmit');
            const input = document.getElementById('waitlistEmail');
            const status = document.getElementById('waitlistStatus');
            btn?.addEventListener('click', async () => {
                const email = input?.value?.trim();
                if (!email) return;
                if (status) status.textContent = "Submitting...";
                try {
                    await DaisyAPI.waitlist({ email });
                    if (status) status.textContent = "You're in. Welcome to the waitlist.";
                    if (input) input.value = "";
                } catch (err) {
                    if (status) status.textContent = err.message || "Unable to submit.";
                }
            });
        }

        (async function initGamification() {
            initActions();
            initAIModes();
            initShopModal();
            initWaitlist();
            initThemeSwitcher();
            pendingTheme = localStorage.getItem("daisy_theme");
            if (window.DaisyAPI?.unlockAll) await window.DaisyAPI.unlockAll();
            if (window.DaisyAPI?.enableUnlimitedCoins) await window.DaisyAPI.enableUnlimitedCoins();
            refreshBalance(false);
            refreshHistory();
            refreshQuests();
        })();
    </script>
</body>

</html>

